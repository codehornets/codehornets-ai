import{_ as ee}from"./syntax-vendor-B5APtO4k.js";import{r as n,j as e}from"./ui-vendor-DaEk3EBW.js";import{c as G,al as se,a as h,ax as S,ay as _,az as T,B as r,Y as I,aA as E,aB as c,aC as te,G as ae,aD as $,A as B,m as N,au as ne,aE as le,T as ie,d as re,e as H,aw as y,aF as P,aG as R,a7 as L,V as w,aH as oe,aI as M,aJ as ce,a9 as de,H as z,_ as me,ap as xe,aK as he}from"./index-CJH4p4E4.js";import{a as ue,s as ge,i as pe}from"./tauri-KcdjxZBy.js";import"./editor-vendor-CFSDMwtX.js";import"./react-vendor-CWc6w16D.js";import"./utils-C7WoKIg-.js";/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=G("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=G("Import",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m8 11 4 4 4-4",key:"1dohi6"}],["path",{d:"M8 5H4a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-4",key:"1ywtjm"}]]),ke=()=>{const[V,O]=n.useState("agents"),[q,m]=n.useState(!1),[v,u]=n.useState(null),[g,b]=n.useState([]),[p,J]=n.useState([]),[X,A]=n.useState(!0),[i,C]=n.useState(null),[Y,x]=n.useState(!1),[j,a]=n.useState(null),[k,f]=n.useState(!1),{createAgentTab:K}=se();n.useEffect(()=>{d(),D()},[]),n.useEffect(()=>{const s=setInterval(()=>{D()},3e3);return()=>clearInterval(s)},[]);const d=async()=>{try{A(!0);const s=await h.listAgents();b(s)}catch(s){console.error("Failed to load agents:",s),a({message:"Failed to load agents",type:"error"})}finally{A(!1)}},D=async()=>{try{const s=await h.listAgentRunsWithMetrics();J(s)}catch(s){console.error("Failed to load running agents:",s)}},F=async s=>{if(!s.id){a({message:"Agent ID is missing",type:"error"});return}const{open:t}=await ee(async()=>{const{open:l}=await import("./tauri-KcdjxZBy.js").then(o=>o.b);return{open:l}},[]);try{const l=await t({directory:!0,multiple:!1,title:`Select project directory for ${s.name}`});if(!l)return;const o=`agent-exec-${s.id}-${Date.now()}`;window.dispatchEvent(new CustomEvent("open-agent-execution",{detail:{agent:s,tabId:o,projectPath:l}})),a({message:`Opening agent: ${s.name}`,type:"success"})}catch(l){console.error("Failed to open agent:",l),a({message:`Failed to open agent: ${s.name}`,type:"error"})}},W=async()=>{if(!(!i||!i.id))try{await h.deleteAgent(i.id),a({message:`Deleted agent: ${i.name}`,type:"success"}),b(s=>s.filter(t=>t.id!==i.id)),x(!1),C(null)}catch(s){console.error("Failed to delete agent:",s),a({message:`Failed to delete agent: ${i.name}`,type:"error"})}},Q=async()=>{try{const s=await ue({filters:[{name:"opcode Agent",extensions:["opcode.json","json"]},{name:"All Files",extensions:["*"]}],multiple:!1});if(s){const t=await h.importAgentFromFile(s);a({message:`Imported agent: ${t.name}`,type:"success"}),d()}}catch(s){console.error("Failed to import agent:",s),a({message:"Failed to import agent",type:"error"})}},U=async s=>{try{const t=await ge({defaultPath:`${s.name.toLowerCase().replace(/\s+/g,"-")}.opcode.json`,filters:[{name:"opcode Agent",extensions:["opcode.json"]}]});t&&s.id&&(await pe("export_agent_to_file",{id:s.id,filePath:t}),a({message:`Exported agent: ${s.name}`,type:"success"}))}catch(t){console.error("Failed to export agent:",t),a({message:"Failed to export agent",type:"error"})}},Z=s=>{switch(s){case"running":return e.jsx(L,{className:"w-4 h-4 animate-spin"});case"completed":return e.jsx(he,{className:"w-4 h-4 text-green-500"});case"failed":return e.jsx(je,{className:"w-4 h-4 text-red-500"});default:return e.jsx(xe,{className:"w-4 h-4 text-muted-foreground"})}};return q?e.jsx(S,{onBack:()=>m(!1),onAgentCreated:()=>{m(!1),d()}}):v?e.jsx(S,{agent:v,onBack:()=>u(null),onAgentCreated:()=>{u(null),d()}}):e.jsx("div",{className:"h-full overflow-y-auto",children:e.jsxs("div",{className:"max-w-6xl mx-auto flex flex-col h-full",children:[e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Agents"}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:"Manage your Claude Code agents"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(_,{children:[e.jsx(T,{asChild:!0,children:e.jsxs(r,{variant:"outline",children:[e.jsx(fe,{className:"w-4 h-4 mr-2"}),"Import",e.jsx(I,{className:"w-4 h-4 ml-2"})]})}),e.jsxs(E,{align:"end",children:[e.jsxs(c,{onClick:Q,children:[e.jsx(te,{className:"w-4 h-4 mr-2"}),"From File"]}),e.jsxs(c,{onClick:()=>f(!0),children:[e.jsx(ae,{className:"w-4 h-4 mr-2"}),"From GitHub"]})]})]}),e.jsxs(r,{onClick:()=>m(!0),children:[e.jsx($,{className:"w-4 h-4 mr-2"}),"Create Agent"]})]})]})}),e.jsx(B,{children:j&&e.jsx(N.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"mx-6 mb-4",children:e.jsx(ne,{message:j.message,type:j.type,onDismiss:()=>a(null)})})}),k&&e.jsx(le,{isOpen:k,onClose:()=>f(!1),onImportSuccess:()=>{d(),f(!1),a({message:"Agent imported successfully",type:"success"})}}),e.jsx(B,{children:Y&&i&&e.jsx(N.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-background/80 backdrop-blur-sm z-50 flex items-center justify-center",onClick:()=>x(!1),children:e.jsxs(N.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},className:"bg-card p-6 rounded-lg shadow-lg max-w-md w-full mx-4",onClick:s=>s.stopPropagation(),children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Delete Agent"}),e.jsxs("p",{className:"text-muted-foreground mb-6",children:['Are you sure you want to delete "',i.name,'"? This action cannot be undone.']}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(r,{variant:"outline",onClick:()=>x(!1),children:"Cancel"}),e.jsx(r,{variant:"destructive",onClick:W,children:"Delete"})]})]})})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:e.jsxs(ie,{value:V,onValueChange:O,className:"w-full",children:[e.jsxs(re,{className:"grid grid-cols-2 w-full max-w-md mb-6 h-auto p-1",children:[e.jsxs(H,{value:"agents",className:"py-2.5 px-3",children:[e.jsx(y,{className:"w-4 h-4 mr-2"}),"Agents (",g.length,")"]}),e.jsxs(H,{value:"running",className:"py-2.5 px-3",children:[e.jsx(P,{className:"w-4 h-4 mr-2"}),"History (",p.length,")"]})]}),e.jsx(R,{value:"agents",className:"flex-1 overflow-hidden",children:X?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(L,{className:"w-8 h-8 animate-spin text-muted-foreground"})}):g.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-center",children:[e.jsx(y,{className:"w-12 h-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Agents Yet"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Create your first agent to get started"}),e.jsxs(r,{onClick:()=>m(!0),children:[e.jsx($,{className:"w-4 h-4 mr-2"}),"Create Agent"]})]}):e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:g.map(s=>e.jsxs(w,{className:"p-4 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{className:"w-5 h-5 text-primary"}),e.jsx("h3",{className:"font-semibold",children:s.name})]}),e.jsxs(_,{children:[e.jsx(T,{asChild:!0,children:e.jsx(r,{variant:"ghost",size:"icon",className:"h-8 w-8",children:e.jsx(I,{className:"w-4 h-4"})})}),e.jsxs(E,{align:"end",children:[e.jsxs(c,{onClick:()=>u(s),children:[e.jsx(oe,{className:"w-4 h-4 mr-2"}),"Edit"]}),e.jsxs(c,{onClick:()=>F(s),children:[e.jsx(M,{className:"w-4 h-4 mr-2"}),"Run"]}),e.jsxs(c,{onClick:()=>U(s),children:[e.jsx(ce,{className:"w-4 h-4 mr-2"}),"Export"]}),e.jsxs(c,{onClick:()=>{C(s),x(!0)},className:"text-destructive",children:[e.jsx(de,{className:"w-4 h-4 mr-2"}),"Delete"]})]})]})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3 line-clamp-2",children:"No description provided"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(z,{variant:"secondary",className:"text-xs",children:"v1.0.0"}),e.jsxs(r,{size:"sm",onClick:()=>F(s),children:[e.jsx(M,{className:"w-3 h-3 mr-1"}),"Run"]})]})]},s.id))})}),e.jsx(R,{value:"running",className:"space-y-6 mt-6",children:p.length===0?e.jsx(w,{className:"p-12",children:e.jsxs("div",{className:"flex flex-col items-center justify-center text-center",children:[e.jsx(P,{className:"w-12 h-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Agent History"}),e.jsx("p",{className:"text-muted-foreground",children:"Run an agent to see it here"})]})}):e.jsx("div",{className:"space-y-4",children:p.map(s=>{var t,l;return e.jsxs(w,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[Z(s.status),e.jsx("h3",{className:"font-semibold",children:s.agent_name}),e.jsx(z,{variant:"outline",className:"text-xs",children:s.status})]}),e.jsx(r,{size:"icon",variant:"ghost",onClick:()=>{var o;return K(((o=s.id)==null?void 0:o.toString())||"",s.agent_name)},className:"h-8 w-8",children:e.jsx(me,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Started:"}),e.jsx("p",{className:"font-medium",children:new Date(s.created_at).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Duration:"}),e.jsx("p",{className:"font-medium",children:(t=s.metrics)!=null&&t.duration_ms?`${(s.metrics.duration_ms/1e3).toFixed(1)}s`:s.duration_ms?`${(s.duration_ms/1e3).toFixed(1)}s`:"—"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Tokens:"}),e.jsx("p",{className:"font-medium",children:(l=s.metrics)!=null&&l.total_tokens?s.metrics.total_tokens.toLocaleString():s.total_tokens?s.total_tokens.toLocaleString():"—"})]})]}),s.status==="failed"&&e.jsx("div",{className:"mt-3 p-2 bg-destructive/10 rounded text-sm text-destructive",children:"Agent execution failed"})]},s.id)})})})]})})]})})};export{ke as Agents};
