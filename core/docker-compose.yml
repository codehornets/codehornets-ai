name: 'codehornets-ai'

services:
  # Orchestrator - Claude CLI instance that coordinates workers
  orchestrator:
    image: docker/sandbox-templates:claude-code
    container_name: orchestrator
    command: >
      bash -c "
      cp /prompts/orchestrator.md /home/agent/workspace/CLAUDE.md &&
      claude
      "
    volumes:
      - ./prompts:/prompts:ro
      - ./shared/auth-homes/orchestrator:/home/agent/.claude:rw
      - ./shared/tasks:/tasks:rw
      - ./shared/results:/results:ro
      - ../workspaces:/workspaces:ro
    environment:
      - NODE_ENV=production
    networks:
      - claude-network
    stdin_open: true
    tty: true
    restart: unless-stopped

  # Marie - Dance teacher assistant
  marie:
    image: docker/sandbox-templates:claude-code
    container_name: marie
    command: >
      bash -c "
      pip install --quiet --break-system-packages reportlab &&
      mkdir -p /home/agent/.claude/output-styles &&
      cp /output-styles/marie.md /home/agent/.claude/output-styles/marie.md &&
      echo '{\"outputStyle\": \"marie\"}' > /home/agent/.claude/settings.local.json &&
      claude
      "
    volumes:
      - ./output-styles:/output-styles:ro
      - ./shared/auth-homes/marie:/home/agent/.claude:rw
      - ./shared/tasks/marie:/tasks:ro
      - ./shared/results/marie:/results:rw
      - ../workspaces/dance:/workspace/dance:rw
      - ./shared/workspaces/marie:/home/agent/workspace:rw
      - ../tools/pdf-generator:/tools/pdf-generator:ro
    networks:
      - claude-network
    stdin_open: true
    tty: true
    restart: unless-stopped

  # Anga - Coding assistant
  anga:
    image: docker/sandbox-templates:claude-code
    container_name: anga
    command: >
      bash -c "
      mkdir -p /home/agent/.claude/output-styles &&
      cp /output-styles/anga.md /home/agent/.claude/output-styles/anga.md &&
      echo '{\"outputStyle\": \"anga\"}' > /home/agent/.claude/settings.local.json &&
      claude
      "
    volumes:
      - ./output-styles:/output-styles:ro
      - ./shared/auth-homes/anga:/home/agent/.claude:rw
      - ./shared/tasks/anga:/tasks:ro
      - ./shared/results/anga:/results:rw
      - ../workspaces/coding:/workspace/coding:rw
      - ./shared/workspaces/anga:/home/agent/workspace:rw
    networks:
      - claude-network
    stdin_open: true
    tty: true
    restart: unless-stopped

  # Fabien - Marketing assistant
  fabien:
    image: docker/sandbox-templates:claude-code
    container_name: fabien
    command: >
      bash -c "
      mkdir -p /home/agent/.claude/output-styles &&
      cp /output-styles/fabien.md /home/agent/.claude/output-styles/fabien.md &&
      echo '{\"outputStyle\": \"fabien\"}' > /home/agent/.claude/settings.local.json &&
      claude
      "
    volumes:
      - ./output-styles:/output-styles:ro
      - ./shared/auth-homes/fabien:/home/agent/.claude:rw
      - ./shared/tasks/fabien:/tasks:ro
      - ./shared/results/fabien:/results:rw
      - ../workspaces/marketing:/workspace/marketing:rw
      - ./shared/workspaces/fabien:/home/agent/workspace:rw
    networks:
      - claude-network
    stdin_open: true
    tty: true
    restart: unless-stopped

networks:
  claude-network:
    driver: bridge
